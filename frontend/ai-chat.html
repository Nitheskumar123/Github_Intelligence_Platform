<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant - GitHub Intelligence Platform</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23007bff' stroke-width='2'><circle cx='12' cy='12' r='10'></circle><path d='M12 2v20M2 12h20'></path></svg>">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="/css/ai-chat.css">
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>

<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <svg class="logo-icon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 2v20M2 12h20"></path>
                </svg>
                <span class="logo-text">GitHub Intelligence</span>
            </div>

            <div class="nav-right">
                <a href="/dashboard/" class="btn-back">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                    Back to Dashboard
                </a>
                <div class="user-profile">
                    <img id="userAvatar" src="" alt="User Avatar" class="user-avatar">
                    <span id="userName" class="user-name">Loading...</span>
                </div>
                <button id="logoutBtn" class="btn-logout">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Main Chat Container -->
    <div class="chat-container">
        <!-- Sidebar with Conversations -->
        <aside class="chat-sidebar">
            <div class="sidebar-header">
                <h2>Conversations</h2>
                <button id="newChatBtn" class="btn-new-chat" title="New Conversation">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>
            <div id="conversationsList" class="conversations-list">
                <div class="loading-state">Loading conversations...</div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-main">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span id="chatTitle">AI Assistant</span>
                </div>
                <div class="chat-actions">
                    <button id="clearChatBtn" class="btn-icon" title="Clear Chat">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Connection Status -->
            <div id="connectionStatus" class="connection-status hidden">
                <div class="status-indicator"></div>
                <span id="statusText">Connecting...</span>
            </div>

            <!-- Chat Messages -->
            <div id="chatMessages" class="chat-messages">
                <!-- Welcome Message -->
                <div class="welcome-message">
                    <div class="welcome-icon">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1.5">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                    </div>
                    <h2>Welcome to AI Assistant!</h2>
                    <p>I can help you manage your GitHub repositories through natural conversation.</p>

                    <div class="example-queries">
                        <h3>Try asking me:</h3>
                        <button class="example-query" data-query="Show me all my repositories">
                            "Show me all my repositories"
                        </button>
                        <button class="example-query" data-query="What pull requests need my review?">
                            "What pull requests need my review?"
                        </button>
                        <button class="example-query" data-query="List my Python repositories">
                            "List my Python repositories"
                        </button>
                        <button class="example-query" data-query="Which repo has the most stars?">
                            "Which repo has the most stars?"
                        </button>
                        <button class="example-query" data-query="Show me open issues">
                            "Show me open issues"
                        </button>
                        <button class="example-query" data-query="Who are my top contributors?">
                            "Who are my top contributors?"
                        </button>
                    </div>
                </div>
            </div>

            <!-- Typing Indicator -->
            <div id="typingIndicator" class="typing-indicator hidden">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea id="chatInput" class="chat-input" placeholder="Ask me anything about your repositories..."
                        rows="1"></textarea>
                    <button id="sendBtn" class="btn-send" disabled>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>
                <div class="input-hint">
                    Press Enter to send, Shift+Enter for new line
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p id="loadingText">Loading...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/markdown-renderer.js"></script>
    <script src="/js/ai-chat.js"></script>
</body>

</html>